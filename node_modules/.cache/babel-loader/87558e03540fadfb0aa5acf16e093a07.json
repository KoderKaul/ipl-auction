{"ast":null,"code":"var _jsxFileName = \"/home/proxin/React/react-js-chat-webapp-example/src/components/JoinRoom/JoinRoom.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from \"react\";\nimport { Link, useHistory } from \"react-router-dom\";\nimport Moment from \"moment\";\nimport firebase from \"../../Firebase\";\nimport useStyles from \"./JoinRoom.styles\";\nimport ExitToAppIcon from \"@material-ui/icons/ExitToApp\";\nimport { Typography, TextField, Container, Button, Toolbar, AppBar, IconButton, Paper, Collapse } from \"@material-ui/core\";\nimport CloseIcon from \"@material-ui/icons/Close\";\nimport Alert from \"@material-ui/lab/Alert\";\nimport rr from \"../../img/rr.jpg\";\nimport csk from \"../../img/csk.jpg\";\nimport rcb from \"../../img/rcb.jpg\";\nimport mi from \"../../img/mi.jpg\";\nimport kxip from \"../../img/kxip.jpg\";\nimport dc from \"../../img/dc.jpg\";\nimport kkr from \"../../img/kkr.jpg\";\nimport ipl from \"../../img/ipl.png\";\n\nfunction JoinRoom() {\n  _s();\n\n  const classes = useStyles();\n  const [myRoom, setMyRoom] = useState(\"\");\n  const [rooms, setRooms] = useState([]);\n  const [showLoading, setShowLoading] = useState(true);\n  const [nickName, setNickName] = useState(\"\");\n  const history = useHistory();\n  const [open, setOpen] = useState(false);\n  useEffect(() => {\n    const fetchData = async () => {\n      setNickName(localStorage.getItem(\"nickName\"));\n      firebase.database().ref(\"rooms/\").on(\"value\", resp => {\n        setRooms([]);\n        setRooms(snapshotToArray(resp));\n        setShowLoading(false);\n      });\n    };\n\n    fetchData();\n  }, []);\n\n  const snapshotToArray = snapshot => {\n    const returnArr = [];\n    snapshot.forEach(childSnapshot => {\n      const item = childSnapshot.val();\n      item.key = childSnapshot.key;\n      returnArr.push(item);\n    });\n    return returnArr;\n  };\n\n  const enterChatmyRoom = myRoomname => {\n    const chat = {\n      roomname: \"\",\n      nickname: \"\",\n      message: \"\",\n      date: \"\",\n      type: \"\"\n    };\n    chat.roomname = myRoomname;\n    chat.nickname = nickName;\n    chat.date = Moment(new Date()).format(\"DD/MM/YYYY HH:mm:ss\");\n    chat.message = `${nickName} enter the room`;\n    chat.type = \"join\";\n    const newMessage = firebase.database().ref(\"chats/\").push();\n    newMessage.set(chat);\n    firebase.database().ref(\"roomusers/\").orderByChild(\"roomname\").equalTo(myRoomname).on(\"value\", resp => {\n      let roomuser = [];\n      roomuser = snapshotToArray(resp);\n      const user = roomuser.find(x => x.nickname === nickName);\n\n      if (user !== undefined) {\n        const userRef = firebase.database().ref('roomusers/' + user.key);\n        userRef.update({\n          status: 'online'\n        });\n      } else {\n        const newroomuser = {\n          roomname: '',\n          nickname: '',\n          status: ''\n        };\n        newroomuser.roomname = roomname;\n        newroomuser.nickname = nickname;\n        newroomuser.status = 'online';\n        const newRoomUser = firebase.database().ref('roomusers/').push();\n        newRoomUser.set(newroomuser);\n      }\n    });\n    history.push(\"/chatroom/\" + myRoomname);\n  };\n\n  const logout = () => {\n    localStorage.removeItem(\"nickName\");\n    history.push(\"/login\");\n  };\n\n  const checkRoom = () => {\n    console.log(rooms);\n    const existingRoom = rooms.find(room => room.roomname === myRoom);\n\n    if (existingRoom) {\n      enterChatmyRoom(myRoom);\n    } else {\n      setOpen(true);\n    }\n  };\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: classes.mainContainer,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 124,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(AppBar, {\n    position: \"static\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 125,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Toolbar, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 126,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Typography, {\n    variant: \"h6\",\n    className: classes.title,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 127,\n      columnNumber: 11\n    }\n  }, \"Welcome \", nickName, \" to IPL Auction Presented by DORA\"), /*#__PURE__*/React.createElement(Button, {\n    color: \"inherit\",\n    onClick: logout,\n    endIcon: /*#__PURE__*/React.createElement(ExitToAppIcon, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 130,\n        columnNumber: 61\n      }\n    }),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 130,\n      columnNumber: 11\n    }\n  }, \"Logout\"))), /*#__PURE__*/React.createElement(Container, {\n    component: \"main\",\n    maxWidth: \"xs\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 135,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Paper, {\n    className: classes.innerContainer,\n    square: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 136,\n      columnNumber: 9\n    }\n  }, nickName === \"AdMiN69\" ? /*#__PURE__*/React.createElement(Link, {\n    to: \"/addroom\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 138,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"img\", {\n    src: ipl,\n    className: classes.iplLogo,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 139,\n      columnNumber: 15\n    }\n  })) : /*#__PURE__*/React.createElement(\"img\", {\n    src: ipl,\n    className: classes.iplLogo,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 142,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(TextField, {\n    label: \"Room\",\n    variant: \"outlined\",\n    placeholder: \"Room\",\n    fullWidth: true,\n    required: true,\n    InputLabelProps: {\n      shrink: true\n    },\n    value: myRoom,\n    onChange: e => {\n      setMyRoom(e.target.value);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 145,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(Button, {\n    color: \"primary\",\n    variant: \"contained\",\n    fullWidth: true,\n    className: classes.submitButton,\n    onClick: checkRoom,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 157,\n      columnNumber: 11\n    }\n  }, \"Join\"), /*#__PURE__*/React.createElement(Collapse, {\n    in: open,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 166,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(Alert, {\n    severity: \"warning\",\n    action: /*#__PURE__*/React.createElement(IconButton, {\n      \"aria-label\": \"close\",\n      color: \"inherit\",\n      size: \"small\",\n      onClick: () => {\n        setOpen(false);\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 170,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(CloseIcon, {\n      fontSize: \"inherit\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 178,\n        columnNumber: 19\n      }\n    })),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 167,\n      columnNumber: 13\n    }\n  }, \"Room Not Found\")))), /*#__PURE__*/React.createElement(\"div\", {\n    className: classes.imgContainer,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 187,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"img\", {\n    src: rr,\n    className: classes.teamImg1,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 188,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(\"img\", {\n    src: csk,\n    className: classes.teamImg2,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 189,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(\"img\", {\n    src: rcb,\n    className: classes.teamImg3,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 190,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(\"img\", {\n    src: mi,\n    className: classes.teamImg4,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 191,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(\"img\", {\n    src: dc,\n    className: classes.teamImg3,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 192,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(\"img\", {\n    src: kxip,\n    className: classes.teamImg2,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 193,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(\"img\", {\n    src: kkr,\n    className: classes.teamImg1,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 194,\n      columnNumber: 9\n    }\n  })));\n}\n\n_s(JoinRoom, \"uIYxxvN+UmnNd4OC1++T6j1fcus=\", false, function () {\n  return [useStyles, useHistory];\n});\n\n_c = JoinRoom;\nexport default JoinRoom;\n/*\n{myRoom.map((item, idx) => (\n                        <ListGroupItem key={idx} action onClick={() => { enterChatmyRoom(item.myRoomname) }}>{item.myRoomname}</ListGroupItem>\n                    ))}\n                */\n\nvar _c;\n\n$RefreshReg$(_c, \"JoinRoom\");","map":{"version":3,"sources":["/home/proxin/React/react-js-chat-webapp-example/src/components/JoinRoom/JoinRoom.js"],"names":["React","useState","useEffect","Link","useHistory","Moment","firebase","useStyles","ExitToAppIcon","Typography","TextField","Container","Button","Toolbar","AppBar","IconButton","Paper","Collapse","CloseIcon","Alert","rr","csk","rcb","mi","kxip","dc","kkr","ipl","JoinRoom","classes","myRoom","setMyRoom","rooms","setRooms","showLoading","setShowLoading","nickName","setNickName","history","open","setOpen","fetchData","localStorage","getItem","database","ref","on","resp","snapshotToArray","snapshot","returnArr","forEach","childSnapshot","item","val","key","push","enterChatmyRoom","myRoomname","chat","roomname","nickname","message","date","type","Date","format","newMessage","set","orderByChild","equalTo","roomuser","user","find","x","undefined","userRef","update","status","newroomuser","newRoomUser","logout","removeItem","checkRoom","console","log","existingRoom","room","mainContainer","title","innerContainer","iplLogo","shrink","e","target","value","submitButton","imgContainer","teamImg1","teamImg2","teamImg3","teamImg4"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport { Link, useHistory } from \"react-router-dom\";\nimport Moment from \"moment\";\nimport firebase from \"../../Firebase\";\nimport useStyles from \"./JoinRoom.styles\";\nimport ExitToAppIcon from \"@material-ui/icons/ExitToApp\";\nimport {\n  Typography,\n  TextField,\n  Container,\n  Button,\n  Toolbar,\n  AppBar,\n  IconButton,\n  Paper,\n  Collapse,\n} from \"@material-ui/core\";\nimport CloseIcon from \"@material-ui/icons/Close\";\nimport Alert from \"@material-ui/lab/Alert\";\nimport rr from \"../../img/rr.jpg\";\nimport csk from \"../../img/csk.jpg\";\nimport rcb from \"../../img/rcb.jpg\";\nimport mi from \"../../img/mi.jpg\";\nimport kxip from \"../../img/kxip.jpg\";\nimport dc from \"../../img/dc.jpg\";\nimport kkr from \"../../img/kkr.jpg\";\nimport ipl from \"../../img/ipl.png\";\n\nfunction JoinRoom() {\n  const classes = useStyles();\n  const [myRoom, setMyRoom] = useState(\"\");\n  const [rooms, setRooms] = useState([]);\n  const [showLoading, setShowLoading] = useState(true);\n  const [nickName, setNickName] = useState(\"\");\n  const history = useHistory();\n  const [open, setOpen] = useState(false);\n\n  useEffect(() => {\n    const fetchData = async () => {\n      setNickName(localStorage.getItem(\"nickName\"));\n      firebase\n        .database()\n        .ref(\"rooms/\")\n        .on(\"value\", (resp) => {\n          setRooms([]);\n          setRooms(snapshotToArray(resp));\n          setShowLoading(false);\n        });\n    };\n\n    fetchData();\n  }, []);\n\n  const snapshotToArray = (snapshot) => {\n    const returnArr = [];\n\n    snapshot.forEach((childSnapshot) => {\n      const item = childSnapshot.val();\n      item.key = childSnapshot.key;\n      returnArr.push(item);\n    });\n\n    return returnArr;\n  };\n\n  const enterChatmyRoom = (myRoomname) => {\n    const chat = {\n      roomname: \"\",\n      nickname: \"\",\n      message: \"\",\n      date: \"\",\n      type: \"\",\n    };\n    chat.roomname = myRoomname;\n    chat.nickname = nickName;\n    chat.date = Moment(new Date()).format(\"DD/MM/YYYY HH:mm:ss\");\n    chat.message = `${nickName} enter the room`;\n    chat.type = \"join\";\n    const newMessage = firebase.database().ref(\"chats/\").push();\n    newMessage.set(chat);\n\n    firebase\n      .database()\n      .ref(\"roomusers/\")\n      .orderByChild(\"roomname\")\n      .equalTo(myRoomname)\n      .on(\"value\", (resp) => {\n        let roomuser = [];\n            roomuser = snapshotToArray(resp);\n            const user = roomuser.find(x => x.nickname === nickName);\n            if (user !== undefined) {\n              const userRef = firebase.database().ref('roomusers/' + user.key);\n              userRef.update({status: 'online'});\n            } else {\n              const newroomuser = { roomname: '', nickname: '', status: '' };\n              newroomuser.roomname = roomname;\n              newroomuser.nickname = nickname;\n              newroomuser.status = 'online';\n              const newRoomUser = firebase.database().ref('roomusers/').push();\n              newRoomUser.set(newroomuser);\n        }\n      });\n\n    history.push(\"/chatroom/\" + myRoomname);\n  };\n\n  const logout = () => {\n    localStorage.removeItem(\"nickName\");\n    history.push(\"/login\");\n  };\n\n  const checkRoom = () => {\n    console.log(rooms);\n    const existingRoom = rooms.find((room) => room.roomname === myRoom);\n\n    if (existingRoom) {\n      enterChatmyRoom(myRoom);\n    } else {\n      setOpen(true);\n    }\n  };\n\n  return (\n    <div className={classes.mainContainer}>\n      <AppBar position=\"static\">\n        <Toolbar>\n          <Typography variant=\"h6\" className={classes.title}>\n            Welcome {nickName} to IPL Auction Presented by DORA\n          </Typography>\n          <Button color=\"inherit\" onClick={logout} endIcon={<ExitToAppIcon />}>\n            Logout\n          </Button>\n        </Toolbar>\n      </AppBar>\n      <Container component=\"main\" maxWidth=\"xs\">\n        <Paper className={classes.innerContainer} square>\n          {nickName === \"AdMiN69\" ? (\n            <Link to=\"/addroom\">\n              <img src={ipl} className={classes.iplLogo} />\n            </Link>\n          ) : (\n            <img src={ipl} className={classes.iplLogo} />\n          )}\n\n          <TextField\n            label=\"Room\"\n            variant=\"outlined\"\n            placeholder=\"Room\"\n            fullWidth\n            required={true}\n            InputLabelProps={{ shrink: true }}\n            value={myRoom}\n            onChange={(e) => {\n              setMyRoom(e.target.value);\n            }}\n          />\n          <Button\n            color=\"primary\"\n            variant=\"contained\"\n            fullWidth\n            className={classes.submitButton}\n            onClick={checkRoom}\n          >\n            Join\n          </Button>\n          <Collapse in={open}>\n            <Alert\n              severity=\"warning\"\n              action={\n                <IconButton\n                  aria-label=\"close\"\n                  color=\"inherit\"\n                  size=\"small\"\n                  onClick={() => {\n                    setOpen(false);\n                  }}\n                >\n                  <CloseIcon fontSize=\"inherit\" />\n                </IconButton>\n              }\n            >\n              Room Not Found\n            </Alert>\n          </Collapse>\n        </Paper>\n      </Container>\n      <div className={classes.imgContainer}>\n        <img src={rr} className={classes.teamImg1} />\n        <img src={csk} className={classes.teamImg2} />\n        <img src={rcb} className={classes.teamImg3} />\n        <img src={mi} className={classes.teamImg4} />\n        <img src={dc} className={classes.teamImg3} />\n        <img src={kxip} className={classes.teamImg2} />\n        <img src={kkr} className={classes.teamImg1} />\n      </div>\n    </div>\n  );\n}\n\nexport default JoinRoom;\n\n/*\n{myRoom.map((item, idx) => (\n                        <ListGroupItem key={idx} action onClick={() => { enterChatmyRoom(item.myRoomname) }}>{item.myRoomname}</ListGroupItem>\n                    ))}\n                */\n"]},"metadata":{},"sourceType":"module"}