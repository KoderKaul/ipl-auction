{"ast":null,"code":"var _jsxFileName = \"/home/proxin/React/react-js-chat-webapp-example/src/components/JoinRoom/JoinRoom.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from \"react\";\nimport { Link, useHistory } from \"react-router-dom\";\nimport Moment from \"moment\";\nimport firebase from \"../../Firebase\";\nimport useStyles from \"./JoinRoom.styles\";\nimport ExitToAppIcon from '@material-ui/icons/ExitToApp';\nimport { Typography, TextField, Container, Button, Toolbar, AppBar, IconButton, Paper } from \"@material-ui/core\";\nimport MenuIcon from \"@material-ui/icons/Menu\";\nimport rr from \"../../img/rr.jpg\";\nimport csk from \"../../img/csk.jpg\";\nimport rcb from \"../../img/rcb.jpg\";\nimport mi from \"../../img/mi.jpg\";\nimport kxip from \"../../img/kxip.jpg\";\nimport dc from \"../../img/dc.jpg\";\nimport kkr from \"../../img/kkr.jpg\";\nimport ipl from \"../../img/ipl.png\";\n\nfunction JoinRoom() {\n  _s();\n\n  const classes = useStyles();\n  const [myRoom, setMyRoom] = useState([]);\n  const [showLoading, setShowLoading] = useState(true);\n  const [nickName, setNickName] = useState(\"\");\n  const history = useHistory();\n  useEffect(() => {\n    const fetchData = async () => {\n      setNickName(localStorage.getItem(\"nickName\"));\n      firebase.database().ref(\"myRooms/\").on(\"value\", resp => {\n        setMyRoom([]);\n        setMyRoom(snapshotToArray(resp));\n        setShowLoading(false);\n      });\n    };\n\n    fetchData();\n  }, []);\n\n  const snapshotToArray = snapshot => {\n    const returnArr = [];\n    snapshot.forEach(childSnapshot => {\n      const item = childSnapshot.val();\n      item.key = childSnapshot.key;\n      returnArr.push(item);\n    });\n    return returnArr;\n  };\n\n  const enterChatmyRoom = myRoomname => {\n    m;\n    const chat = {\n      myRoomname: \"\",\n      nickName: \"\",\n      message: \"\",\n      date: \"\",\n      type: \"\"\n    };\n    chat.myRoomname = myRoomname;\n    chat.nickName = nickName;\n    chat.date = Moment(new Date()).format(\"DD/MM/YYYY HH:mm:ss\");\n    chat.message = `${nickName} enter the myRoom`;\n    chat.type = \"join\";\n    const newMessage = firebase.database().ref(\"chats/\").push();\n    newMessage.set(chat);\n    firebase.database().ref(\"myRoomusers/\").orderByChild(\"myRoomname\").equalTo(myRoomname).on(\"value\", resp => {\n      let myRoomuser = [];\n      myRoomuser = snapshotToArray(resp);\n      const user = myRoomuser.find(x => x.nickName === nickName);\n\n      if (user !== undefined) {\n        const userRef = firebase.database().ref(\"myRoomusers/\" + user.key);\n        userRef.update({\n          status: \"online\"\n        });\n      } else {\n        const newmyRoomuser = {\n          myRoomname: \"\",\n          nickname: \"\",\n          status: \"\"\n        };\n        newmyRoomuser.myRoomname = myRoomname;\n        newmyRoomuser.nickName = nickName;\n        newmyRoomuser.status = \"online\";\n        const newmyRoomUser = firebase.database().ref(\"myRoomusers/\").push();\n        newmyRoomUser.set(newmyRoomuser);\n      }\n    });\n    history.push(\"/chatmyRoom/\" + myRoomname);\n  };\n\n  const logout = () => {\n    localStorage.removeItem(\"nickName\");\n    history.push(\"/login\");\n  };\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: classes.mainContainer,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 111,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(AppBar, {\n    position: \"static\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 112,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Toolbar, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 113,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Typography, {\n    variant: \"h6\",\n    className: classes.title,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 114,\n      columnNumber: 11\n    }\n  }, \"Welcome \", nickName, \" to IPL Auction Presented by DORA\"), /*#__PURE__*/React.createElement(Button, {\n    color: \"inherit\",\n    onClick: logout,\n    endIcon: /*#__PURE__*/React.createElement(ExitToAppIcon, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 117,\n        columnNumber: 61\n      }\n    }),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 117,\n      columnNumber: 11\n    }\n  }, \"Logout\"))), /*#__PURE__*/React.createElement(Container, {\n    component: \"main\",\n    maxWidth: \"xs\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 122,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Paper, {\n    className: classes.innerContainer,\n    square: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 123,\n      columnNumber: 9\n    }\n  }, nickName === \"AdMiN69\" ? /*#__PURE__*/React.createElement(Link, {\n    to: \"/addroom\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 125,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"img\", {\n    src: ipl,\n    className: classes.iplLogo,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 126,\n      columnNumber: 15\n    }\n  })) : /*#__PURE__*/React.createElement(\"img\", {\n    src: ipl,\n    className: classes.iplLogo,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 129,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(TextField, {\n    label: \"Room\",\n    variant: \"outlined\",\n    placeholder: \"Room\",\n    fullWidth: true,\n    required: true,\n    InputLabelProps: {\n      shrink: true\n    },\n    value: myRoom,\n    onChange: e => {\n      setMyRoom(e.target.value);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 132,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(Button, {\n    color: \"primary\",\n    variant: \"contained\",\n    fullWidth: true,\n    className: classes.submitButton,\n    onClick: enterChatmyRoom,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 144,\n      columnNumber: 11\n    }\n  }, \"Join\"))), /*#__PURE__*/React.createElement(\"div\", {\n    className: classes.imgContainer,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 155,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"img\", {\n    src: rr,\n    className: classes.teamImg1,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 156,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(\"img\", {\n    src: csk,\n    className: classes.teamImg2,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 157,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(\"img\", {\n    src: rcb,\n    className: classes.teamImg3,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 158,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(\"img\", {\n    src: mi,\n    className: classes.teamImg4,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 159,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(\"img\", {\n    src: dc,\n    className: classes.teamImg3,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 160,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(\"img\", {\n    src: kxip,\n    className: classes.teamImg2,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 161,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(\"img\", {\n    src: kkr,\n    className: classes.teamImg1,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 162,\n      columnNumber: 9\n    }\n  })));\n}\n\n_s(JoinRoom, \"OZfZLHhvdEqnTX6y87KQgNLdQGQ=\", false, function () {\n  return [useStyles, useHistory];\n});\n\n_c = JoinRoom;\nexport default JoinRoom;\n/*\n{myRoom.map((item, idx) => (\n                        <ListGroupItem key={idx} action onClick={() => { enterChatmyRoom(item.myRoomname) }}>{item.myRoomname}</ListGroupItem>\n                    ))}\n                */\n\nvar _c;\n\n$RefreshReg$(_c, \"JoinRoom\");","map":{"version":3,"sources":["/home/proxin/React/react-js-chat-webapp-example/src/components/JoinRoom/JoinRoom.js"],"names":["React","useState","useEffect","Link","useHistory","Moment","firebase","useStyles","ExitToAppIcon","Typography","TextField","Container","Button","Toolbar","AppBar","IconButton","Paper","MenuIcon","rr","csk","rcb","mi","kxip","dc","kkr","ipl","JoinRoom","classes","myRoom","setMyRoom","showLoading","setShowLoading","nickName","setNickName","history","fetchData","localStorage","getItem","database","ref","on","resp","snapshotToArray","snapshot","returnArr","forEach","childSnapshot","item","val","key","push","enterChatmyRoom","myRoomname","m","chat","message","date","type","Date","format","newMessage","set","orderByChild","equalTo","myRoomuser","user","find","x","undefined","userRef","update","status","newmyRoomuser","nickname","newmyRoomUser","logout","removeItem","mainContainer","title","innerContainer","iplLogo","shrink","e","target","value","submitButton","imgContainer","teamImg1","teamImg2","teamImg3","teamImg4"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport { Link, useHistory } from \"react-router-dom\";\nimport Moment from \"moment\";\nimport firebase from \"../../Firebase\";\nimport useStyles from \"./JoinRoom.styles\";\nimport ExitToAppIcon from '@material-ui/icons/ExitToApp';\nimport {\n  Typography,\n  TextField,\n  Container,\n  Button,\n  Toolbar,\n  AppBar,\n  IconButton,\n  Paper,\n} from \"@material-ui/core\";\nimport MenuIcon from \"@material-ui/icons/Menu\";\nimport rr from \"../../img/rr.jpg\";\nimport csk from \"../../img/csk.jpg\";\nimport rcb from \"../../img/rcb.jpg\";\nimport mi from \"../../img/mi.jpg\";\nimport kxip from \"../../img/kxip.jpg\";\nimport dc from \"../../img/dc.jpg\";\nimport kkr from \"../../img/kkr.jpg\";\nimport ipl from \"../../img/ipl.png\";\n\nfunction JoinRoom() {\n  const classes = useStyles();\n  const [myRoom, setMyRoom] = useState([]);\n  const [showLoading, setShowLoading] = useState(true);\n  const [nickName, setNickName] = useState(\"\");\n  const history = useHistory();\n\n  useEffect(() => {\n    const fetchData = async () => {\n      setNickName(localStorage.getItem(\"nickName\"));\n      firebase\n        .database()\n        .ref(\"myRooms/\")\n        .on(\"value\", (resp) => {\n          setMyRoom([]);\n          setMyRoom(snapshotToArray(resp));\n          setShowLoading(false);\n        });\n    };\n\n    fetchData();\n  }, []);\n\n  const snapshotToArray = (snapshot) => {\n    const returnArr = [];\n\n    snapshot.forEach((childSnapshot) => {\n      const item = childSnapshot.val();\n      item.key = childSnapshot.key;\n      returnArr.push(item);\n    });\n\n    return returnArr;\n  };\n\n  const enterChatmyRoom = (myRoomname) => {\n\n    m\n    const chat = {\n      myRoomname: \"\",\n      nickName: \"\",\n      message: \"\",\n      date: \"\",\n      type: \"\",\n    };\n    chat.myRoomname = myRoomname;\n    chat.nickName = nickName;\n    chat.date = Moment(new Date()).format(\"DD/MM/YYYY HH:mm:ss\");\n    chat.message = `${nickName} enter the myRoom`;\n    chat.type = \"join\";\n    const newMessage = firebase.database().ref(\"chats/\").push();\n    newMessage.set(chat);\n\n    firebase\n      .database()\n      .ref(\"myRoomusers/\")\n      .orderByChild(\"myRoomname\")\n      .equalTo(myRoomname)\n      .on(\"value\", (resp) => {\n        let myRoomuser = [];\n        myRoomuser = snapshotToArray(resp);\n        const user = myRoomuser.find((x) => x.nickName === nickName);\n        if (user !== undefined) {\n          const userRef = firebase.database().ref(\"myRoomusers/\" + user.key);\n          userRef.update({ status: \"online\" });\n        } else {\n          const newmyRoomuser = { myRoomname: \"\", nickname: \"\", status: \"\" };\n          newmyRoomuser.myRoomname = myRoomname;\n          newmyRoomuser.nickName = nickName;\n          newmyRoomuser.status = \"online\";\n          const newmyRoomUser = firebase.database().ref(\"myRoomusers/\").push();\n          newmyRoomUser.set(newmyRoomuser);\n        }\n      });\n\n    history.push(\"/chatmyRoom/\" + myRoomname);\n  };\n\n  const logout = () => {\n    localStorage.removeItem(\"nickName\");\n    history.push(\"/login\");\n  };\n\n  return (\n    <div className={classes.mainContainer}>\n      <AppBar position=\"static\">\n        <Toolbar>\n          <Typography variant=\"h6\" className={classes.title}>\n            Welcome {nickName} to IPL Auction Presented by DORA\n          </Typography>\n          <Button color=\"inherit\" onClick={logout} endIcon={<ExitToAppIcon/>}>\n            Logout\n          </Button>\n        </Toolbar>\n      </AppBar>\n      <Container component=\"main\" maxWidth=\"xs\">\n        <Paper className={classes.innerContainer} square>\n          {nickName === \"AdMiN69\" ? (\n            <Link to=\"/addroom\">\n              <img src={ipl} className={classes.iplLogo} />\n            </Link>\n          ) : (\n            <img src={ipl} className={classes.iplLogo} />\n          )}\n\n          <TextField\n            label=\"Room\"\n            variant=\"outlined\"\n            placeholder=\"Room\"\n            fullWidth\n            required={true}\n            InputLabelProps={{ shrink: true }}\n            value={myRoom}\n            onChange={(e) => {\n              setMyRoom(e.target.value);\n            }}\n          />\n          <Button\n            color=\"primary\"\n            variant=\"contained\"\n            fullWidth\n            className={classes.submitButton}\n            onClick={enterChatmyRoom}\n          >\n            Join\n          </Button>\n        </Paper>\n      </Container>\n      <div className={classes.imgContainer}>\n        <img src={rr} className={classes.teamImg1} />\n        <img src={csk} className={classes.teamImg2} />\n        <img src={rcb} className={classes.teamImg3} />\n        <img src={mi} className={classes.teamImg4} />\n        <img src={dc} className={classes.teamImg3} />\n        <img src={kxip} className={classes.teamImg2} />\n        <img src={kkr} className={classes.teamImg1} />\n      </div>\n    </div>\n  );\n}\n\nexport default JoinRoom;\n\n/*\n{myRoom.map((item, idx) => (\n                        <ListGroupItem key={idx} action onClick={() => { enterChatmyRoom(item.myRoomname) }}>{item.myRoomname}</ListGroupItem>\n                    ))}\n                */"]},"metadata":{},"sourceType":"module"}